# 积木识别
- 原始图像：形状由5个视角的图像组成，颜色由1个视角
- 图像增强：颜色、形状分类采取不同的图像增强策略；1. ==颜色变换（图像的亮度、对比度、饱和度和色相等颜色特征调整）==；旋转；平移； 缩放； 裁剪； 2. 旋转；平移；
- 欠拟合：调整了学习率0.0001，学习率预热，学习率衰减， 优化器
- 过拟合：早停，
- 除了算法上：色衰、颜色校正


# 测量

图像预处理（灰度化、去噪、边缘检测、形态学操作）
焊印轮廓检测（cv2.findcontours()识别焊印区域；`cv2.boundingRect()` 或 `cv2.minAreaRect()` 计算尺寸）



# 缺陷检测

极耳焊接缺陷：漏焊、断焊、爆点、针孔
顶盖焊接缺陷：漏焊、断焊、炸点、针孔

## OpenCV

- 1.预处理（灰度化、去噪、增强对比度）；2.边缘检测； 3.轮廓检测； 4.形态学处理

## AI
- 图像质量
	- 2D相机：选择合适的相机和镜头，保证图像分辨率、帧率等满足检测需求。如检测微小缺陷需高分辨率相机；高速焊接过程需高帧率相机捕获瞬间图像。同时，考虑照明系统稳定性和均匀性，减少反光、阴影等干扰对成像的影响；
	- 3D相机（**线结构光相机**）：光照条件，物体反射性和光滑度；焊缝几何形状的变化；相机分辨率与精度
- 数据集质量
	- 数据多样性：采集涵盖不同焊接工艺参数（如激光功率、焊接速度、脉冲频率等）、材料类型、环境条件下的焊接图像，确保数据能反映实际生产中的各种情况，提升模型泛化能力。例如，在焊接不同材质的金属时，缺陷表现可能不同，都应包含在数据集中
	- 类间均衡：如果各类别的样本数量差异过大，模型会倾向于在样本多的类别上学习更多特征，而对样本少的类别学习不足
	- 数据标注：遵循不错标、不漏标、不过标、不少标的原则。不错标即不对非缺陷区域标注或用错缺陷类型，否则模型会学习错误信息；不漏标是将所有缺陷区域标注或掩膜处理，避免模型将未标注缺陷区域误判为正常；不过标指标注时可适度超出缺陷边界，但不过度，防止正常区域被误学为缺陷；不少标要求对缺陷完整标注，否则模型会将未标注部分当成正常区域
	- 图像增强：**亮度和对比度调整**；**平移**；**缩放**；旋转和翻转（不适用）
- 模型
	- 解决相似任务
- 超参调节
	- 权重初始化：预训练权重
	- 损失函数：Cross-Entropy Loss、Dice  Loss、Focal Loss
	- 防止欠拟合：学习率、学习率调度器、训练轮数
	- 防止过拟合：正则化（**L1 和 L2 正则化**、**Dropout**）；减小模型复杂度（宽度、深度）、收集图像、早停
	
- 模型部署与量化
	- 部署流程： 
		- 模型转换：*.pt  ==> *.onnx ==> *.engine
		- 构建TensorRT引擎：自定义日志记录器 ==> 构建推理引擎 ==> 前处理 ==> 推理 ==> 后处理
		
	- 存在问题与解决方案：
		- **精度损失问题**：
			- 问题：在从 FP32 转换到低精度（FP16 或 INT8）时，会因为数据精度降低而导致模型精度损失，影响激光焊接缺陷检测的准确率。大多数情况下，模型在 FP16 精度下仍能保持较高的准确率。
			- 解决方案：1.**精度验证**：在量化后，进行充分的精度验证，确保量化过程不会大幅影响模型的准确性。可以通过在量化前后对比精度（如AP值、召回率、F1分数等）来验证精度变化；2. **混合精度推理**：TensorRT支持混合精度推理，可以在不同层之间使用不同的精度（如FP16和INT8），以提高推理速度的同时尽量减少精度损失。3.**动态范围量化**：如果量化导致过大的精度损失，可以使用TensorRT的动态范围量化技术，它能够在一定程度上减少精度损失。
		- **后处理与输出格式问题**：
			- 问题：TensorRT优化后的模型可能会在推理时输出不同于原始模型的格式，可能会导致与原始YOLOv8的后处理不一致。
			- 解决方案：根据TensorRT推理结果修改后处理代码，确保输出框的解码、NMS（非极大值抑制）等操作与YOLOv8原始实现一致。
		- **环境部署问题**：
			- 问题：TensorRT 依赖于特定版本的 CUDA、cuDNN 等库以及GPU，可能会出现库版本不兼容的问题，导致 TensorRT 无法正常工作
			- 解决方案：确保部署环境中安装的 CUDA、cuDNN 等库版本与 TensorRT 兼容


