---
tags: [optimization, gradient-descent, steepest-descent, BGD, SGD, MBGD]
aliases: [æ¢¯åº¦ä¸‹é™æ³•è¯¦è§£]
---
---
# ğŸ“˜ æœ€é€Ÿä¸‹é™æ–¹å‘ï¼ˆSteepest Descent Directionï¼‰

## 1. åŸºæœ¬æ¦‚å¿µ
å¯¹äºä¸€ä¸ªäºŒå…ƒå‡½æ•° $z = f(x, y)$ï¼Œåœ¨ç‚¹ $(x, y)$ å¤„çš„å…¨å¢é‡ï¼š
$$
\Delta z = f(x + \Delta x, y + \Delta y) - f(x, y)
$$

## 2. çº¿æ€§è¿‘ä¼¼ï¼ˆå¯å¾®æƒ…å½¢ï¼‰
å½“å‡½æ•°å¯å¾®æ—¶ï¼Œå¯ç”¨å…¨å¾®åˆ†è¿‘ä¼¼ï¼š
$$
\Delta z \approx \frac{\partial f}{\partial x} \Delta x + \frac{\partial f}{\partial y} \Delta y
$$
å…¶ä¸­ $\approx$ è¡¨ç¤ºå¿½ç•¥é«˜é˜¶æ— ç©·å° $o\left(\sqrt{(\Delta x)^2 + (\Delta y)^2}\right)$ã€‚

## 3. å‘é‡å½¢å¼è¡¨ç¤º
å®šä¹‰**æ¢¯åº¦å‘é‡**å’Œ**ä½ç§»å‘é‡**ï¼š
$$
\nabla f = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} \right)
$$
$$
\mathbf{v} = (\Delta x, \Delta y)
$$

å¢é‡å¯å†™ä¸ºå†…ç§¯å½¢å¼ï¼š
$$
\Delta z \approx \nabla f \cdot \mathbf{v}
$$

## 4. å‡ ä½•è§£é‡Š
ç”±å‘é‡å†…ç§¯å…¬å¼ï¼š
$$
\nabla f \cdot \mathbf{v} = \|\nabla f\| \|\mathbf{v}\| \cos\theta
$$
å…¶ä¸­ $\theta$ æ˜¯ä¸¤å‘é‡å¤¹è§’ã€‚

## 5. æœ€é€Ÿä¸‹é™æ–¹å‘æ¨å¯¼
ä¸ºä½¿ $\Delta z$ **æœ€å°**ï¼ˆä¸‹é™æœ€å¿«ï¼‰ï¼Œå½“ $\|\mathbf{v}\|$ å›ºå®šæ—¶ï¼Œéœ€ $\cos\theta = -1$ï¼Œå³ï¼š
$$
\theta = \pi
$$
è¿™æ„å‘³ç€ $\mathbf{v}$ ä¸ $\nabla f$ **æ–¹å‘å®Œå…¨ç›¸å**ã€‚

## 6. ä¸‹é™æ–¹å‘å…¬å¼
**æœ€ä¼˜ä¸‹é™æ–¹å‘**ä¸ºï¼š
$$
\mathbf{v} = -\eta \cdot \frac{\nabla f}{\|\nabla f\|}
$$
å…¶ä¸­ $\eta > 0$ æ˜¯å­¦ä¹ ç‡ï¼Œ$\eta = \|\mathbf{v}\|$ã€‚

**å®è·µå½¢å¼**ï¼ˆå¸¸çœç•¥å½’ä¸€åŒ–ï¼‰ï¼š
$$
(\Delta x, \Delta y) = -\eta \nabla f
$$
å³ï¼š
$$
\Delta x = -\eta \frac{\partial f}{\partial x}, \quad \Delta y = -\eta \frac{\partial f}{\partial y}
$$

---
# ğŸ“Š ä¸‰ç§åŸºç¡€æ¢¯åº¦ä¸‹é™ï¼ˆBGDã€SGDã€MBGDï¼‰æ–¹æ³•å¯¹æ¯”

## æ ¸å¿ƒæ¦‚å¿µè¡¨
| ç‰¹æ€§ | **BGDï¼ˆæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰** | **SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰** | **MBGDï¼ˆå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰** |
|------|------------------------|------------------------|--------------------------|
| **å…¨ç§°** | Batch Gradient Descent | Stochastic Gradient Descent | Mini-Batch Gradient Descent |
| **æ¯æ¬¡æ›´æ–°æ•°æ®é‡** | å…¨æ•°æ®é›† | å•ä¸ªæ ·æœ¬ | å°æ‰¹é‡æ ·æœ¬ |
| **æ¢¯åº¦å™ªå£°** | æ— å™ªå£° | å™ªå£°å¤§ | å™ªå£°ä¸­ç­‰ |
| **æ”¶æ•›ç¨³å®šæ€§** | ç¨³å®šï¼Œå•è°ƒæ”¶æ•› | éœ‡è¡å‰§çƒˆ | ç›¸å¯¹ç¨³å®š |
| **æ”¶æ•›é€Ÿåº¦** | æ¯æ¬¡è¿­ä»£æ…¢ï¼Œæ€»è¿­ä»£æ¬¡æ•°å°‘ | æ¯æ¬¡è¿­ä»£å¿«ï¼Œæ€»è¿­ä»£æ¬¡æ•°å¤š | æŠ˜ä¸­ |
| **å†…å­˜éœ€æ±‚** | å¤§ï¼ˆéœ€å…¨æ•°æ®ï¼‰ | å° | ä¸­ç­‰ |
| **èƒ½å¦å¹¶è¡Œ** | å¯ä»¥ | å¾ˆéš¾ | éå¸¸é€‚åˆ |
| **å¸¸è§åº”ç”¨** | å‡¸ä¼˜åŒ–ã€å°æ•°æ®é›† | åœ¨çº¿å­¦ä¹ ã€å¤§è§„æ¨¡æ•°æ® | **æ·±åº¦å­¦ä¹ æ ‡é…** |

## æ›´æ–°å…¬å¼å¯¹æ¯”
**BGDï¼ˆæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰**ï¼š
$$
\theta_{t+1} = \theta_t - \eta \cdot \frac{1}{N} \sum_{i=1}^N \nabla L_i(\theta)
$$

**SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰**ï¼š
$$
\theta_{t+1} = \theta_t - \eta \cdot \nabla L_k(\theta) \quad (k \text{éšæœº})
$$

**MBGDï¼ˆå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰**ï¼š
$$
\theta_{t+1} = \theta_t - \eta \cdot \frac{1}{B} \sum_{i=1}^B \nabla L_i(\theta)
$$

---

# ğŸ”¢ åŸºç¡€ä¼˜åŒ–å™¨æ‰‹åŠ¨è®¡ç®—ç¤ºä¾‹

## ğŸ“‹ é—®é¢˜è®¾å®š

### è®­ç»ƒæ•°æ®
| $i$ | $x$ | $y$ (çœŸå®å€¼) |
|-----|-----|-------------|
| 1   | 1.0 | 2.0         |
| 2   | 2.0 | 4.0         |
| 3   | 3.0 | 6.0         |
| 4   | 4.0 | 8.0         |

### æ¨¡å‹ä¸å‚æ•°
ç®€å•çº¿æ€§æ¨¡å‹ï¼š
$$
\hat{y} = wx + b
$$

æŸå¤±å‡½æ•°ï¼ˆMSEï¼‰ï¼š
$$
L(w,b) = \frac{1}{N} \sum_{i=1}^N (wx_i + b - y_i)^2
$$

**åˆå§‹åŒ–å‚æ•°**ï¼š
$$
w_0 = 0.5, \quad b_0 = 0.5, \quad \eta = 0.1
$$

### æ¢¯åº¦å…¬å¼
å¯¹æ¯ä¸ªæ ·æœ¬ $i$ï¼š
$$
\hat{y}_i = wx_i + b
$$
$$
\frac{\partial L_i}{\partial w} = 2(wx_i + b - y_i) \cdot x_i
$$
$$
\frac{\partial L_i}{\partial b} = 2(wx_i + b - y_i)
$$

## ğŸ“ˆ BGDï¼ˆæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰è®¡ç®—
**ç¬¬1è½®è¿­ä»£ï¼ˆä½¿ç”¨å…¨éƒ¨4ä¸ªæ ·æœ¬ï¼‰**

### é¢„æµ‹å€¼ä¸è¯¯å·®
| $i$ | $x_i$ | $y_i$ | $\hat{y}_i = 0.5x_i + 0.5$ | $\hat{y}_i - y_i$ |
|-----|-------|-------|---------------------------|------------------|
| 1   | 1.0   | 2.0   | $1.0$                     | $-1.0$           |
| 2   | 2.0   | 4.0   | $1.5$                     | $-2.5$           |
| 3   | 3.0   | 6.0   | $2.0$                     | $-4.0$           |
| 4   | 4.0   | 8.0   | $2.5$                     | $-5.5$           |

### æ¢¯åº¦è®¡ç®—
**å¯¹ $w$ çš„æ¢¯åº¦**ï¼š
$$
\begin{aligned}
\frac{\partial L_1}{\partial w} &= 2 \times (-1.0) \times 1.0 = -2.0 \\
\frac{\partial L_2}{\partial w} &= 2 \times (-2.5) \times 2.0 = -10.0 \\
\frac{\partial L_3}{\partial w} &= 2 \times (-4.0) \times 3.0 = -24.0 \\
\frac{\partial L_4}{\partial w} &= 2 \times (-5.5) \times 4.0 = -44.0
\end{aligned}
$$

**å¯¹ $b$ çš„æ¢¯åº¦**ï¼š
$$
\begin{aligned}
\frac{\partial L_1}{\partial b} &= 2 \times (-1.0) = -2.0 \\
\frac{\partial L_2}{\partial b} &= 2 \times (-2.5) = -5.0 \\
\frac{\partial L_3}{\partial b} &= 2 \times (-4.0) = -8.0 \\
\frac{\partial L_4}{\partial b} &= 2 \times (-5.5) = -11.0
\end{aligned}
$$

### å¹³å‡æ¢¯åº¦
$$
\frac{\partial L}{\partial w} = \frac{1}{4} \sum_{i=1}^4 \frac{\partial L_i}{\partial w} = \frac{-2.0 -10.0 -24.0 -44.0}{4} = -20.0
$$
$$
\frac{\partial L}{\partial b} = \frac{1}{4} \sum_{i=1}^4 \frac{\partial L_i}{\partial b} = \frac{-2.0 -5.0 -8.0 -11.0}{4} = -6.5
$$

### å‚æ•°æ›´æ–°
$$
\begin{aligned}
w_1 &= w_0 - \eta \frac{\partial L}{\partial w} = 0.5 - 0.1 \times (-20.0) = 2.5 \\
b_1 &= b_0 - \eta \frac{\partial L}{\partial b} = 0.5 - 0.1 \times (-6.5) = 1.15
\end{aligned}
$$

**BGDç»“æœ**ï¼š$w_1 = 2.5$, $b_1 = 1.15$

## ğŸ² SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰è®¡ç®—
**ç¬¬1è½®è¿­ä»£ï¼ˆéšæœºé€‰æ‹©æ ·æœ¬ $i=2$ï¼‰**

æ ·æœ¬æ•°æ®ï¼š$x=2.0, y=4.0$

### è®¡ç®—å•ä¸ªæ ·æœ¬æ¢¯åº¦
$$
\hat{y} = 0.5 \times 2.0 + 0.5 = 1.5
$$
$$
\hat{y} - y = 1.5 - 4.0 = -2.5
$$
$$
\begin{aligned}
\frac{\partial L_2}{\partial w} &= 2 \times (-2.5) \times 2.0 = -10.0 \\
\frac{\partial L_2}{\partial b} &= 2 \times (-2.5) = -5.0
\end{aligned}
$$

### å‚æ•°æ›´æ–°
$$
\begin{aligned}
w_1^{\text{SGD}} &= 0.5 - 0.1 \times (-10.0) = 1.5 \\
b_1^{\text{SGD}} &= 0.5 - 0.1 \times (-5.0) = 1.0
\end{aligned}
$$

**SGDç»“æœ**ï¼š$w_1 = 1.5$, $b_1 = 1.0$

## ğŸ“¦ MBGDï¼ˆå°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰è®¡ç®—
**ç¬¬1è½®è¿­ä»£ï¼ˆbatch size = 2ï¼Œé€‰æ‹©æ ·æœ¬1å’Œ3ï¼‰**

### æ‰¹å†…æ ·æœ¬æ¢¯åº¦
**æ ·æœ¬1** ($x=1.0, y=2.0$)ï¼š
$$
\frac{\partial L_1}{\partial w} = -2.0, \quad \frac{\partial L_1}{\partial b} = -2.0
$$

**æ ·æœ¬3** ($x=3.0, y=6.0$)ï¼š
$$
\frac{\partial L_3}{\partial w} = -24.0, \quad \frac{\partial L_3}{\partial b} = -8.0
$$

### æ‰¹å†…å¹³å‡æ¢¯åº¦
$$
\frac{\partial L_{\text{batch}}}{\partial w} = \frac{-2.0 + (-24.0)}{2} = -13.0
$$
$$
\frac{\partial L_{\text{batch}}}{\partial b} = \frac{-2.0 + (-8.0)}{2} = -5.0
$$

### å‚æ•°æ›´æ–°
$$
\begin{aligned}
w_1^{\text{MBGD}} &= 0.5 - 0.1 \times (-13.0) = 1.8 \\
b_1^{\text{MBGD}} &= 0.5 - 0.1 \times (-5.0) = 1.0
\end{aligned}
$$

**MBGDç»“æœ**ï¼š$w_1 = 1.8$, $b_1 = 1.0$

---

# ğŸ“š é«˜çº§ä¼˜åŒ–å™¨å®šä¹‰ä¸åˆ†ç±»

## 1. å¸¦åŠ¨é‡çš„ä¼˜åŒ–å™¨ï¼ˆMomentum-based Optimizersï¼‰

### **Momentumï¼ˆåŠ¨é‡æ³•ï¼‰**
**å®šä¹‰**ï¼šåœ¨æ¢¯åº¦ä¸‹é™åŸºç¡€ä¸Šå¼•å…¥**åŠ¨é‡é¡¹**ï¼Œå°†å†å²æ¢¯åº¦ä¿¡æ¯ä»¥æŒ‡æ•°è¡°å‡æ–¹å¼ç´¯ç§¯ï¼ŒåŠ é€Ÿæ”¶æ•›å¹¶å‡å°‘éœ‡è¡ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- ç±»ä¼¼äºç‰©ç†å­¦ä¸­çš„åŠ¨é‡
- å½“å‰æ›´æ–°æ–¹å‘ = å†å²åŠ¨é‡ + å½“å‰æ¢¯åº¦æ–¹å‘
- æœ‰åŠ©äºå¹³æ»‘æ¢¯åº¦æ›´æ–°ï¼ŒåŠ é€Ÿæ”¶æ•›

**æ•°å­¦å…¬å¼**ï¼š
$$
\begin{aligned}
v_t &= \beta v_{t-1} + \eta \nabla_\theta L(\theta_t) \\
\theta_{t+1} &= \theta_t - v_t
\end{aligned}
$$
å…¶ä¸­ï¼š
- $v_t$ï¼šç¬¬ $t$ æ­¥çš„åŠ¨é‡
- $\beta$ï¼šåŠ¨é‡ç³»æ•°ï¼ˆé€šå¸¸ 0.9ï¼‰
- $\eta$ï¼šå­¦ä¹ ç‡
- $\nabla_\theta L(\theta_t)$ï¼šå½“å‰æ¢¯åº¦

**é€‚ç”¨åœºæ™¯**ï¼š
- æ¢¯åº¦æ–¹å‘å˜åŒ–è¾ƒå¤§çš„é—®é¢˜
- éœ€è¦åŠ é€Ÿæ”¶æ•›çš„åœºæ™¯
- é«˜æ›²ç‡æˆ–å™ªå£°è¾ƒå¤šçš„ä¼˜åŒ–æ›²é¢

---

### **Nesterov Accelerated Gradient (NAG)**
**å®šä¹‰**ï¼šæ”¹è¿›çš„åŠ¨é‡æ³•ï¼Œå…ˆæ ¹æ®åŠ¨é‡é¡¹"å‘å‰çœ‹"ä¸€æ­¥ï¼Œå†è®¡ç®—æ¢¯åº¦ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- "å…ˆçœ‹å†è·³"ï¼ˆLook-aheadï¼‰
- åœ¨åŠ¨é‡ç‚¹å¤„è®¡ç®—æ¢¯åº¦ï¼Œæ›´å‡†ç¡®åœ°é¢„æµ‹ä¸‹ä¸€æ­¥

**æ•°å­¦å…¬å¼**ï¼š
$$
\begin{aligned}
v_t &= \beta v_{t-1} + \eta \nabla_\theta L(\theta_t - \beta v_{t-1}) \\
\theta_{t+1} &= \theta_t - v_t
\end{aligned}
$$

**ä¼˜ç‚¹**ï¼š
- æ”¶æ•›é€Ÿåº¦æ¯”æ ‡å‡† Momentum æ›´å¿«
- å¯¹å‡¸å‡½æ•°æœ‰ç†è®ºä¿è¯
- å‡å°‘è¿‡å†²ç°è±¡

---

## 2. è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–å™¨ï¼ˆAdaptive Learning Rate Optimizersï¼‰

### **Adagrad**
**å®šä¹‰**ï¼šä¸º**æ¯ä¸ªå‚æ•°**è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡ï¼Œæ ¹æ®å†å²æ¢¯åº¦å¹³æ–¹å’Œè¿›è¡Œè°ƒæ•´ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- é¢‘ç¹æ›´æ–°çš„å‚æ•°è·å¾—è¾ƒå°çš„å­¦ä¹ ç‡
- ä¸é¢‘ç¹æ›´æ–°çš„å‚æ•°è·å¾—è¾ƒå¤§çš„å­¦ä¹ ç‡
- é€‚åˆç¨€ç–æ•°æ®

**æ•°å­¦å…¬å¼**ï¼š
$$
\begin{aligned}
G_{t,ii} &= G_{t-1,ii} + (\nabla_\theta L(\theta_{t,i}))^2 \\
\theta_{t+1,i} &= \theta_{t,i} - \frac{\eta}{\sqrt{G_{t,ii} + \epsilon}} \cdot \nabla_\theta L(\theta_{t,i})
\end{aligned}
$$
å…¶ä¸­ï¼š
- $G_t$ï¼šå¯¹è§’çŸ©é˜µï¼Œç´¯ç§¯æ¢¯åº¦å¹³æ–¹å’Œ
- $\epsilon$ï¼šé˜²æ­¢é™¤é›¶çš„å°å¸¸æ•°ï¼ˆé€šå¸¸ $10^{-8}$ï¼‰

**å±€é™æ€§**ï¼š
- å­¦ä¹ ç‡å•è°ƒé€’å‡è‡³ 0
- ç´¯ç§¯æ¢¯åº¦å¹³æ–¹å’Œå¯èƒ½è¿‡å¤§

---

### **RMSprop**
**å®šä¹‰**ï¼šæ”¹è¿›çš„ Adagradï¼Œä½¿ç”¨**æŒ‡æ•°ç§»åŠ¨å¹³å‡**ä»£æ›¿ç´¯ç§¯å’Œï¼Œè§£å†³å­¦ä¹ ç‡è¿‡å¿«è¡°å‡é—®é¢˜ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- åªè€ƒè™‘æœ€è¿‘ä¸€æ®µæ—¶é—´çš„æ¢¯åº¦
- å­¦ä¹ ç‡ä¸ä¼šå•è°ƒé€’å‡è‡³ 0

**æ•°å­¦å…¬å¼**ï¼š
$$
\begin{aligned}
E[g^2]_t &= \beta E[g^2]_{t-1} + (1-\beta) (\nabla_\theta L(\theta_t))^2 \\
\theta_{t+1} &= \theta_t - \frac{\eta}{\sqrt{E[g^2]_t + \epsilon}} \cdot \nabla_\theta L(\theta_t)
\end{aligned}
$$
å…¶ä¸­ $\beta$ é€šå¸¸å– 0.9ã€‚

**é€‚ç”¨åœºæ™¯**ï¼š
- éå¹³ç¨³ç›®æ ‡å‡½æ•°
- å¾ªç¯ç¥ç»ç½‘ç»œè®­ç»ƒ

---

### **Adamï¼ˆAdaptive Moment Estimationï¼‰**
**å®šä¹‰**ï¼šç»“åˆ**åŠ¨é‡æ³•**å’Œ**RMSprop**çš„è‡ªé€‚åº”ä¼˜åŒ–å™¨ï¼Œä½¿ç”¨**ä¸€é˜¶çŸ©ä¼°è®¡**å’Œ**äºŒé˜¶çŸ©ä¼°è®¡**ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- åŠ¨é‡ï¼šä¼°è®¡æ¢¯åº¦çš„ä¸€é˜¶çŸ©ï¼ˆå‡å€¼ï¼‰
- RMSpropï¼šä¼°è®¡æ¢¯åº¦çš„äºŒé˜¶çŸ©ï¼ˆæ–¹å·®ï¼‰
- åå·®ä¿®æ­£ï¼šè§£å†³åˆå§‹åå·®é—®é¢˜

**æ•°å­¦å…¬å¼**ï¼š
$$
\begin{aligned}
\text{ä¸€é˜¶çŸ©ä¼°è®¡ï¼š} & m_t = \beta_1 m_{t-1} + (1-\beta_1) g_t \\
\text{äºŒé˜¶çŸ©ä¼°è®¡ï¼š} & v_t = \beta_2 v_{t-1} + (1-\beta_2) g_t^2 \\
\text{åå·®ä¿®æ­£ï¼š} & \hat{m}_t = \frac{m_t}{1-\beta_1^t}, \quad \hat{v}_t = \frac{v_t}{1-\beta_2^t} \\
\text{å‚æ•°æ›´æ–°ï¼š} & \theta_{t+1} = \theta_t - \frac{\eta}{\sqrt{\hat{v}_t} + \epsilon} \cdot \hat{m}_t
\end{aligned}
$$

**é»˜è®¤è¶…å‚æ•°**ï¼š
- $\beta_1 = 0.9$ï¼šä¸€é˜¶çŸ©è¡°å‡ç‡
- $\beta_2 = 0.999$ï¼šäºŒé˜¶çŸ©è¡°å‡ç‡
- $\epsilon = 10^{-8}$ï¼šæ•°å€¼ç¨³å®šå¸¸æ•°

**ä¼˜ç‚¹**ï¼š
- è‡ªé€‚åº”å­¦ä¹ ç‡
- åŠ¨é‡åŠ é€Ÿ
- åå·®ä¿®æ­£
- åœ¨å®è·µä¸­è¡¨ç°ä¼˜ç§€

---

### **AdamW**
**å®šä¹‰**ï¼šæ”¹è¿›çš„ Adamï¼Œå°†**æƒé‡è¡°å‡**ä¸æ¢¯åº¦æ›´æ–°**è§£è€¦**ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- ä¼ ç»Ÿ Adamï¼šæƒé‡è¡°å‡ä¸æ¢¯åº¦ç¼©æ”¾è€¦åˆ
- AdamWï¼šæƒé‡è¡°å‡ç‹¬ç«‹äºè‡ªé€‚åº”å­¦ä¹ ç‡

**æ•°å­¦å…¬å¼**ï¼š
$$
\theta_{t+1} = \theta_t - \eta \left( \frac{\hat{m}_t}{\sqrt{\hat{v}_t} + \epsilon} + \lambda \theta_t \right)
$$
å…¶ä¸­ $\lambda$ æ˜¯æƒé‡è¡°å‡ç³»æ•°ã€‚

**ä¼˜ç‚¹**ï¼š
- æ›´å¥½çš„æ³›åŒ–æ€§èƒ½
- åœ¨ Transformer ç­‰æ¨¡å‹ä¸­è¡¨ç°æ›´ä½³
- æƒé‡è¡°å‡æ›´ç¨³å®š

---

## 3. å…¶ä»–ä¼˜åŒ–å™¨

### **AdaDelta**
**å®šä¹‰**ï¼šæ— éœ€è®¾ç½®å­¦ä¹ ç‡çš„è‡ªé€‚åº”ä¼˜åŒ–å™¨ï¼Œè‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- ä½¿ç”¨æ¢¯åº¦å¹³æ–¹çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡
- ä½¿ç”¨å‚æ•°æ›´æ–°å¹³æ–¹çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡
- å®Œå…¨è‡ªé€‚åº”ï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®å­¦ä¹ ç‡

**æ•°å­¦å…¬å¼**ï¼š
$$
\begin{aligned}
E[g^2]_t &= \rho E[g^2]_{t-1} + (1-\rho) g_t^2 \\
\Delta\theta_t &= -\frac{\sqrt{E[\Delta\theta^2]_{t-1} + \epsilon}}{\sqrt{E[g^2]_t + \epsilon}} \cdot g_t \\
E[\Delta\theta^2]_t &= \rho E[\Delta\theta^2]_{t-1} + (1-\rho) \Delta\theta_t^2
\end{aligned}
$$

---

### **Nadam**
**å®šä¹‰**ï¼šAdam + Nesterov åŠ¨é‡ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- ç»“åˆ Adam çš„è‡ªé€‚åº”å­¦ä¹ ç‡
- ç»“åˆ Nesterov çš„å‘å‰çœ‹ç‰¹æ€§

**æ•°å­¦å…¬å¼**ï¼š
$$
\theta_{t+1} = \theta_t - \frac{\eta}{\sqrt{\hat{v}_t} + \epsilon} \left( \beta_1 \hat{m}_t + \frac{1-\beta_1}{1-\beta_1^t} g_t \right)
$$

---

## 4. äºŒé˜¶ä¼˜åŒ–æ–¹æ³•

### **ç‰›é¡¿æ³•**
**å®šä¹‰**ï¼šä½¿ç”¨**HessiançŸ©é˜µ**ï¼ˆäºŒé˜¶å¯¼æ•°ï¼‰çš„ä¼˜åŒ–æ–¹æ³•ã€‚

**æ•°å­¦å…¬å¼**ï¼š
$$
\theta_{t+1} = \theta_t - [Hf(\theta_t)]^{-1} \nabla f(\theta_t)
$$
å…¶ä¸­ $Hf(\theta_t)$ æ˜¯ Hessian çŸ©é˜µã€‚

**ä¼˜ç‚¹**ï¼š
- äºŒæ¬¡æ”¶æ•›é€Ÿåº¦
- å¯¹äºå‡¸å‡½æ•°æ•ˆç‡æé«˜

**ç¼ºç‚¹**ï¼š
- è®¡ç®— Hessian çŸ©é˜µåŠå…¶é€†å¤æ‚åº¦é«˜
- å­˜å‚¨éœ€æ±‚å¤§

---

### **æ‹Ÿç‰›é¡¿æ³•ï¼ˆL-BFGSï¼‰**
**å®šä¹‰**ï¼šè¿‘ä¼¼ Hessian çŸ©é˜µçš„ä¼˜åŒ–æ–¹æ³•ï¼Œé¿å…ç›´æ¥è®¡ç®—ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
- ç»´æŠ¤ Hessian çŸ©é˜µçš„è¿‘ä¼¼
- åªå­˜å‚¨æœ€è¿‘çš„æ¢¯åº¦ä¿¡æ¯
- å†…å­˜æ•ˆç‡æ›´é«˜

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¸­ç­‰è§„æ¨¡çš„ä¼˜åŒ–é—®é¢˜
- éœ€è¦äºŒé˜¶ä¿¡æ¯ä½†è®¡ç®—èµ„æºæœ‰é™

---


# ğŸš€ é«˜çº§ä¼˜åŒ–å™¨æ‰‹åŠ¨è®¡ç®—ç¤ºä¾‹

## ğŸ“‹ é«˜çº§ä¼˜åŒ–å™¨è®¡ç®—è®¾å®š
å»¶ç»­ç›¸åŒæ•°æ®ï¼Œä½†ä½¿ç”¨æ›´å¤æ‚çš„ä¼˜åŒ–å™¨ï¼š
- åˆå§‹å‚æ•°ï¼š$w_0 = 0.5, b_0 = 0.5$
- å­¦ä¹ ç‡ï¼š$\eta = 0.1$
- åŠ¨é‡ç³»æ•°ï¼š$\beta = 0.9$
- Adamè¶…å‚æ•°ï¼š$\beta_1=0.9, \beta_2=0.999, \epsilon=10^{-8}$

### è®¡ç®—å‰æ
å‡è®¾æˆ‘ä»¬å¤„ç†**å°æ‰¹é‡ï¼ˆæ ·æœ¬1å’Œ3ï¼‰**ï¼Œæ¢¯åº¦å¦‚MBGDè®¡ç®—ï¼š
$$
g_w = -13.0, \quad g_b = -5.0
$$

## ğŸ”„ Momentumï¼ˆåŠ¨é‡æ³•ï¼‰æ‰‹åŠ¨è®¡ç®—

### ç¬¬1æ¬¡è¿­ä»£
åˆå§‹åŒ–åŠ¨é‡ï¼š$m_w^0 = 0, m_b^0 = 0$

**æ›´æ–°åŠ¨é‡**ï¼š
$$
\begin{aligned}
m_w^1 &= \beta m_w^0 + \eta g_w = 0.9 \times 0 + 0.1 \times (-13.0) = -1.3 \\
m_b^1 &= \beta m_b^0 + \eta g_b = 0.9 \times 0 + 0.1 \times (-5.0) = -0.5
\end{aligned}
$$

**å‚æ•°æ›´æ–°**ï¼š
$$
\begin{aligned}
w_1 &= w_0 - m_w^1 = 0.5 - (-1.3) = 1.8 \\
b_1 &= b_0 - m_b^1 = 0.5 - (-0.5) = 1.0
\end{aligned}
$$

### ç¬¬2æ¬¡è¿­ä»£ï¼ˆå‡è®¾æ–°æ¢¯åº¦ï¼š$g_w = -10.0, g_b = -4.0$ï¼‰
**æ›´æ–°åŠ¨é‡**ï¼š
$$
\begin{aligned}
m_w^2 &= \beta m_w^1 + \eta g_w = 0.9 \times (-1.3) + 0.1 \times (-10.0) = -1.17 - 1.0 = -2.17 \\
m_b^2 &= \beta m_b^1 + \eta g_b = 0.9 \times (-0.5) + 0.1 \times (-4.0) = -0.45 - 0.4 = -0.85
\end{aligned}
$$

**å‚æ•°æ›´æ–°**ï¼š
$$
\begin{aligned}
w_2 &= w_1 - m_w^2 = 1.8 - (-2.17) = 3.97 \\
b_2 &= b_1 - m_b^2 = 1.0 - (-0.85) = 1.85
\end{aligned}
$$

**Momentumç»“æœ**ï¼š$w_2 = 3.97$, $b_2 = 1.85$ï¼ˆç›¸æ¯”SGDçš„1.5æœ‰**åŠ é€Ÿæ•ˆæœ**ï¼‰

## ğŸ“Š Adagrad æ‰‹åŠ¨è®¡ç®—

### ç¬¬1æ¬¡è¿­ä»£
åˆå§‹åŒ–æ¢¯åº¦å¹³æ–¹ç´¯ç§¯ï¼š$G_w^0 = 0, G_b^0 = 0$
$\epsilon = 10^{-8}$

**è®¡ç®—è°ƒæ•´åçš„å­¦ä¹ ç‡**ï¼š
$$
\begin{aligned}
G_w^1 &= G_w^0 + (g_w)^2 = 0 + (-13.0)^2 = 169.0 \\
G_b^1 &= G_b^0 + (g_b)^2 = 0 + (-5.0)^2 = 25.0
\end{aligned}
$$

**å‚æ•°æ›´æ–°**ï¼š
$$
\begin{aligned}
w_1 &= w_0 - \frac{\eta}{\sqrt{G_w^1 + \epsilon}} \cdot g_w = 0.5 - \frac{0.1}{\sqrt{169.0 + 10^{-8}}} \times (-13.0) \\
&= 0.5 - \frac{0.1}{13.0} \times (-13.0) = 0.5 + 0.1 = 0.6
\end{aligned}
$$
$$
\begin{aligned}
b_1 &= b_0 - \frac{\eta}{\sqrt{G_b^1 + \epsilon}} \cdot g_b = 0.5 - \frac{0.1}{\sqrt{25.0 + 10^{-8}}} \times (-5.0) \\
&= 0.5 - \frac{0.1}{5.0} \times (-5.0) = 0.5 + 0.1 = 0.6
\end{aligned}
$$

### ç¬¬2æ¬¡è¿­ä»£ï¼ˆå‡è®¾æ–°æ¢¯åº¦ï¼š$g_w = -5.0, g_b = -2.0$ï¼‰
**æ›´æ–°æ¢¯åº¦å¹³æ–¹ç´¯ç§¯**ï¼š
$$
\begin{aligned}
G_w^2 &= G_w^1 + (g_w)^2 = 169.0 + (-5.0)^2 = 169.0 + 25.0 = 194.0 \\
G_b^2 &= G_b^1 + (g_b)^2 = 25.0 + (-2.0)^2 = 25.0 + 4.0 = 29.0
\end{aligned}
$$

**å‚æ•°æ›´æ–°**ï¼š
$$
\begin{aligned}
w_2 &= w_1 - \frac{\eta}{\sqrt{G_w^2 + \epsilon}} \cdot g_w = 0.6 - \frac{0.1}{\sqrt{194.0}} \times (-5.0) \\
&= 0.6 - \frac{0.1}{13.93} \times (-5.0) = 0.6 + 0.0359 = 0.6359
\end{aligned}
$$
$$
\begin{aligned}
b_2 &= b_1 - \frac{\eta}{\sqrt{G_b^2 + \epsilon}} \cdot g_b = 0.6 - \frac{0.1}{\sqrt{29.0}} \times (-2.0) \\
&= 0.6 - \frac{0.1}{5.385} \times (-2.0) = 0.6 + 0.0371 = 0.6371
\end{aligned}
$$

**Adagradç‰¹ç‚¹**ï¼šå­¦ä¹ ç‡ä¸æ–­å‡å°ï¼Œæ›´æ–°å¹…åº¦è¶Šæ¥è¶Šå°

## ğŸ¯ Adam æ‰‹åŠ¨è®¡ç®—

### ç¬¬1æ¬¡è¿­ä»£
åˆå§‹åŒ–ï¼š$m_w^0 = 0, v_w^0 = 0, m_b^0 = 0, v_b^0 = 0$
è¶…å‚æ•°ï¼š$\beta_1=0.9, \beta_2=0.999, \epsilon=10^{-8}, t=1$

**ä¸€é˜¶çŸ©ä¼°è®¡**ï¼š
$$
\begin{aligned}
m_w^1 &= \beta_1 m_w^0 + (1-\beta_1) g_w = 0.9 \times 0 + 0.1 \times (-13.0) = -1.3 \\
m_b^1 &= \beta_1 m_b^0 + (1-\beta_1) g_b = 0.9 \times 0 + 0.1 \times (-5.0) = -0.5
\end{aligned}
$$

**äºŒé˜¶çŸ©ä¼°è®¡**ï¼š
$$
\begin{aligned}
v_w^1 &= \beta_2 v_w^0 + (1-\beta_2) (g_w)^2 = 0.999 \times 0 + 0.001 \times 169.0 = 0.169 \\
v_b^1 &= \beta_2 v_b^0 + (1-\beta_2) (g_b)^2 = 0.999 \times 0 + 0.001 \times 25.0 = 0.025
\end{aligned}
$$

**åå·®ä¿®æ­£**ï¼š
$$
\begin{aligned}
\hat{m}_w^1 &= \frac{m_w^1}{1-\beta_1^1} = \frac{-1.3}{1-0.9} = -13.0 \\
\hat{m}_b^1 &= \frac{m_b^1}{1-\beta_1^1} = \frac{-0.5}{0.1} = -5.0 \\
\hat{v}_w^1 &= \frac{v_w^1}{1-\beta_2^1} = \frac{0.169}{1-0.999} = 169.0 \\
\hat{v}_b^1 &= \frac{v_b^1}{1-\beta_2^1} = \frac{0.025}{0.001} = 25.0
\end{aligned}
$$

**å‚æ•°æ›´æ–°**ï¼š
$$
\begin{aligned}
w_1 &= w_0 - \eta \frac{\hat{m}_w^1}{\sqrt{\hat{v}_w^1} + \epsilon} = 0.5 - 0.1 \times \frac{-13.0}{\sqrt{169.0} + 10^{-8}} \\
&= 0.5 - 0.1 \times \frac{-13.0}{13.0} = 0.5 + 0.1 = 0.6
\end{aligned}
$$
$$
\begin{aligned}
b_1 &= b_0 - \eta \frac{\hat{m}_b^1}{\sqrt{\hat{v}_b^1} + \epsilon} = 0.5 - 0.1 \times \frac{-5.0}{\sqrt{25.0} + 10^{-8}} \\
&= 0.5 - 0.1 \times \frac{-5.0}{5.0} = 0.5 + 0.1 = 0.6
\end{aligned}
$$

### ç¬¬2æ¬¡è¿­ä»£ï¼ˆ$t=2$ï¼Œå‡è®¾æ–°æ¢¯åº¦ï¼š$g_w = -5.0, g_b = -2.0$ï¼‰
**ä¸€é˜¶çŸ©ä¼°è®¡**ï¼š
$$
\begin{aligned}
m_w^2 &= \beta_1 m_w^1 + (1-\beta_1) g_w = 0.9 \times (-1.3) + 0.1 \times (-5.0) = -1.67 \\
m_b^2 &= \beta_1 m_b^1 + (1-\beta_1) g_b = 0.9 \times (-0.5) + 0.1 \times (-2.0) = -0.65
\end{aligned}
$$

**äºŒé˜¶çŸ©ä¼°è®¡**ï¼š
$$
\begin{aligned}
v_w^2 &= \beta_2 v_w^1 + (1-\beta_2) (g_w)^2 = 0.999 \times 0.169 + 0.001 \times 25.0 = 0.168831 + 0.025 = 0.193831 \\
v_b^2 &= \beta_2 v_b^1 + (1-\beta_2) (g_b)^2 = 0.999 \times 0.025 + 0.001 \times 4.0 = 0.024975 + 0.004 = 0.028975
\end{aligned}
$$

**åå·®ä¿®æ­£**ï¼š
$$
\begin{aligned}
\hat{m}_w^2 &= \frac{m_w^2}{1-\beta_1^2} = \frac{-1.67}{1-0.9^2} = \frac{-1.67}{1-0.81} = \frac{-1.67}{0.19} = -8.7895 \\
\hat{m}_b^2 &= \frac{m_b^2}{1-\beta_1^2} = \frac{-0.65}{0.19} = -3.4211 \\
\hat{v}_w^2 &= \frac{v_w^2}{1-\beta_2^2} = \frac{0.193831}{1-0.999^2} = \frac{0.193831}{1-0.998001} = \frac{0.193831}{0.001999} = 96.9645 \\
\hat{v}_b^2 &= \frac{v_b^2}{1-\beta_2^2} = \frac{0.028975}{0.001999} = 14.4947
\end{aligned}
$$

**å‚æ•°æ›´æ–°**ï¼š
$$
\begin{aligned}
w_2 &= w_1 - \eta \frac{\hat{m}_w^2}{\sqrt{\hat{v}_w^2} + \epsilon} = 0.6 - 0.1 \times \frac{-8.7895}{\sqrt{96.9645} + 10^{-8}} \\
&= 0.6 - 0.1 \times \frac{-8.7895}{9.8471} = 0.6 + 0.0892 = 0.6892
\end{aligned}
$$
$$
\begin{aligned}
b_2 &= b_1 - \eta \frac{\hat{m}_b^2}{\sqrt{\hat{v}_b^2} + \epsilon} = 0.6 - 0.1 \times \frac{-3.4211}{\sqrt{14.4947} + 10^{-8}} \\
&= 0.6 - 0.1 \times \frac{-3.4211}{3.8072} = 0.6 + 0.0899 = 0.6899
\end{aligned}
$$

**Adamç»“æœ**ï¼š$w_2 = 0.6892$, $b_2 = 0.6899$

---

# ğŸ“ˆ ä¼˜åŒ–å™¨å¯¹æ¯”ä¸é€‰æ‹©æŒ‡å—

## ğŸ“Š æ€§èƒ½å¯¹æ¯”æ€»ç»“

### ä¸¤è½®è¿­ä»£åç»“æœå¯¹æ¯”
| ä¼˜åŒ–å™¨ | $w_2$ | $b_2$ | ç‰¹ç‚¹ |
|--------|-------|-------|------|
| **SGD** | 1.5 | 1.0 | åŸºç¡€ï¼Œå™ªå£°å¤§ |
| **Momentum** | 3.97 | 1.85 | **åŠ é€Ÿæ˜æ˜¾**ï¼ŒåŠ¨é‡ç´¯ç§¯ |
| **Adagrad** | 0.6359 | 0.6371 | å­¦ä¹ ç‡è¡°å‡å¿« |
| **Adam** | 0.6892 | 0.6899 | è‡ªé€‚åº”å­¦ä¹ ç‡+åŠ¨é‡ |

### æ”¶æ•›ç‰¹æ€§å¯¹æ¯”
1. **Momentum**ï¼šæ›´æ–°å¹…åº¦æœ€å¤§ï¼ŒåŠ é€Ÿæ”¶æ•›
2. **Adagrad**ï¼šæ›´æ–°è°¨æ…ï¼Œå­¦ä¹ ç‡å¿«é€Ÿè¡°å‡
3. **Adam**ï¼šå¹³è¡¡è‡ªé€‚åº”å’ŒåŠ¨é‡ï¼Œæœ€ç¨³å®š

## ğŸ¯ ä¼˜åŒ–å™¨é€‰æ‹©æŒ‡å—

### å¿«é€Ÿé€‰æ‹©è¡¨
| åœºæ™¯         | æ¨èä¼˜åŒ–å™¨          | ç†ç”±            | å…¸å‹å­¦ä¹ ç‡        |
| ---------- | -------------- | ------------- | ------------ |
| **åˆå­¦è€…/æ•™å­¦** | SGD/MBGD       | ç†è§£åŸç†          | 0.01-0.1     |
| **æ ‡å‡†æ·±åº¦å­¦ä¹ ** | **Adam/AdamW** | è‡ªé€‚åº”ï¼Œç¨³å®š        | 1e-3 to 3e-4 |
| **è®¡ç®—æœºè§†è§‰**  | AdamW          | æƒé‡è¡°å‡è§£è€¦        | 1e-3         |
| **è‡ªç„¶è¯­è¨€å¤„ç†** | AdamW          | Transformerä¼˜åŒ– | 2e-5 to 5e-5 |
| **ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ** | Adam (Î²â‚=0.5)  | ç¨³å®šè®­ç»ƒ          | 2e-4         |
| **å¼ºåŒ–å­¦ä¹ **   | Adam           | é€šç”¨æ€§å¥½          | 1e-4 to 3e-4 |
| **å¾ªç¯ç¥ç»ç½‘ç»œ** | RMSprop        | å†å²åŸå›           | 1e-3         |
| **ç¨€ç–æ•°æ®**   | Adagrad        | è‡ªé€‚åº”è°ƒæ•´         | 0.01         |

### å®è·µæŠ€å·§
```python
# PyTorch ä¼˜åŒ–å™¨é…ç½®ç¤ºä¾‹
import torch.optim as optim

# 1. AdamWï¼ˆæ¨èé»˜è®¤ï¼‰
optimizer = optim.AdamW(model.parameters(), lr=0.001, weight_decay=0.01)

# 2. SGD with Momentumï¼ˆæŸäº›ä»»åŠ¡æ›´å¥½ï¼‰
optimizer = optim.SGD(model.parameters(), lr=0.01, momentum=0.9, weight_decay=0.0005)

# 3. å­¦ä¹ ç‡è°ƒåº¦
scheduler = optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=100)