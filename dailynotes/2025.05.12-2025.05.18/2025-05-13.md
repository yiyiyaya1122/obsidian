#todo 
- [x] 确定堆上与没堆上伺服曲线的差异
- [x] 尾端x突变原因查明
- [ ] 堆叠成功率提升以及实际偏差校正

# 一、确定堆上与没堆上伺服曲线的差异

## 堆上
![[Pasted image 20250513091610.png]]

![[Pasted image 20250513091622.png]]

![[Pasted image 20250513091633.png]]

## 无法堆上

### 1.
![[Pasted image 20250513091825.png]]

![[Pasted image 20250513091836.png]]

![[Pasted image 20250513091849.png]]

### 2

![[Pasted image 20250513092157.png]]

![[Pasted image 20250513092207.png]]

![[Pasted image 20250513092220.png]]

### 3


![[Pasted image 20250513092413.png]]

![[Pasted image 20250513092421.png]]


![[Pasted image 20250513092429.png]]

## 结论
**不同点**
1. 能堆上时总体跳变较小
2. 能堆上时尾端跳变较小

**结论**
1. 尾端x减小1~2cm左右，需查明原因，推测不能堆的原因可能是endpoint需保持稳定，x、y 在±5mm，角度±0.5°
2. 总体跳变影响



# 二、尾端x突变原因查明

## 1.现象
分析伺服曲线发现在尾端x会突然减小1~2cm左右，推测由于其不符合结束点的跳变要求，因此导致agv继续运动
![[f1684657414d336495cca22ea17aae0f.png]]
## 2.设计实验
1. 跑一个类似的伺服曲线
2. 分析log及点云
3. 稳定性分析


## 3.实验结果
1. 点云保存时覆盖，缺少关键帧点云
2. 从log看上方锡锭x计算不会存在问题，主要是下方锡锭
3. 下方锡锭x是动的，如何确定其稳定性？


## 4.可能原因
1. 货叉根部超过下方锡锭，下方点云受roi滤波影响照不全导致跳变
2. 锡锭是梯形的

## 5.结论
roi_init的x=loadPositionX + 0.02，当AGV靠近下方锡锭时，下方锡锭的点云被横向切开，导致x跳变
![[Pasted image 20250513162547.png]]

## 6.疑问
理论上增大loadPositionX可扩充roi



# 三、堆叠成功率提升以及实际偏差校正

## 1.点云缺失

**现象**
agv靠近下方锡锭时，下方锡锭点云宽度比真实值小3~4cm

**影响**
y方向检测不准

**解决方案**
- 当检测到点云缺失时，提前结束堆叠对齐检测
- 寻找稳定的特征
- 测试loadPositionX+0.475m的效果

